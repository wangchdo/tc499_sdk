/**********************************************************************************************************************
 * \file Ifx_Cfg_Ssw.c
 * \brief Configuration file for the Startup Software
 * \copyright Copyright (C) Infineon Technologies AG 2019
 * 
 * Use of this file is subject to the terms of use agreed between (i) you or the company in which ordinary course of 
 * business you are acting and (ii) Infineon Technologies AG or its licensees. If and as long as no such terms of use
 * are agreed, use of this file is subject to following:
 * 
 * Boost Software License - Version 1.0 - August 17th, 2003
 * 
 * Permission is hereby granted, free of charge, to any person or organization obtaining a copy of the software and 
 * accompanying documentation covered by this license (the "Software") to use, reproduce, display, distribute, execute,
 * and transmit the Software, and to prepare derivative works of the Software, and to permit third-parties to whom the
 * Software is furnished to do so, all subject to the following:
 * 
 * The copyright notices in the Software and this entire statement, including the above license grant, this restriction
 * and the following disclaimer, must be included in all copies of the Software, in whole or in part, and all 
 * derivative works of the Software, unless such copies or derivative works are solely in the form of 
 * machine-executable object code generated by a source language processor.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
 * WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE 
 * COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN 
 * CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS 
 * IN THE SOFTWARE.
 *********************************************************************************************************************/

/*********************************************************************************************************************/
/*-----------------------------------------------------Includes------------------------------------------------------*/
/*********************************************************************************************************************/

#include "Ifx_Cfg_Ssw.h"
#include "Ifx_Ssw_Infra.h"

/*********************************************************************************************************************/
/*---------------------------------------------Function Implementations----------------------------------------------*/
/*********************************************************************************************************************/
#if defined(__TASKING__)
#pragma optimize RL
#elif defined(__HIGHTEC__) && !defined(__clang__)
#pragma GCC optimize ("O1")
#elif defined(__GNUC__) && !defined(__HIGHTEC__)
#pragma GCC optimize ("O1")
#endif

/* Hook API for PMS Initialization
 * This hook is referenced in Startup sequence. This need to be configured by application to
 * initialize the PMS EVR module. This hook is by default defined to empty call by startup implementation.
 */
#if (IFX_CFG_SSW_ENABLE_PMS_INIT == 1U)
void Ifx_Ssw_Pms_Init(void)
{
    /* TODO: To be updated as per A3G spec */
}


/* Hook API for PMS Initialization check
 * This hook is referenced in Startup sequence. This need to be configured by application to
 * cross verify the PMS configuration with the required values. This hook is by default defined to empty
 * call by startup implementation.
 */
#if (IFX_CFG_SSW_ENABLE_PMS_INIT_CHECK == 1U)
void Ifx_Ssw_Pms_InitCheck(void)
{
    /* TODO: To be updated as per A3G spec */
}


#endif /* End of Ifx_Ssw_Pms_InitCheck() */
#endif /* End of Ifx_Ssw_Pms_Init() */

/* Hook API for LBIST check
 * This hook is referenced in Startup sequence. This need to be configured by application to
 * do LBIST checks. This hook is by default defined to empty call by startup implementation.
 */
#if (IFX_CFG_SSW_ENABLE_LBIST == 1)
void Ifx_Ssw_Lbist(void)
{
    /* TODO: To be updated as per A3G spec */
}


#endif

/* Hook API for MONBIST check
 * This hook is referenced in Startup sequence. This need to be configured by application to
 * do MONBIST checks. This hook is by default defined to empty call by startup implementation.
 */
#if (IFX_CFG_SSW_ENABLE_MONBIST == 1)
void Ifx_Ssw_Monbist(void)
{
    /* TODO: To be updated as per A3G spec */
}


#endif

/* Hook API do MBIST for DSPR0-DSPR5
 * This hook is referenced in Startup sequence. This need to be configured by application to
 * do MBIST for DSPR0. This hook is by default defined to empty call by startup implementation.
 */
#if (IFX_CFG_SSW_ENABLE_MBIST_DSPRS_DMARAM == 1)
void Ifx_Ssw_MbistDsprsDmaRam(void)
{
    /* TODO: To be updated as per A3G spec */
}


#endif

/* Hook API to shutdown the unused power domains
 * This hook is referenced in Startup sequence. This need to be configured by application to
 * to shutdown the unused power domains. This hook is by default defined to empty call by startup implementation.
 */
#if (IFX_CFG_SSW_ENABLE_SHUTDOWN_UNUSED_PWRDOMAINS == 1)
void Ifx_Ssw_ShutdownPwrDomains(void)
{
}

#endif

/* Callout hook API macro for PLL initialization
 * This callout hook is referenced in Startup sequence. This need to be configured by application to
 * initialize the PLL. This hook is by default defined to empty call by startup implementation.
 */
#if IFX_CFG_SSW_ENABLE_PLL_INIT == 1U
#include "IfxClock.h"

void Ifx_Ssw_PowerOnCrystalOsc(void)
{
    Ifx_CLOCK_OSCCON scuOsccon;
    unsigned int     initError         = 0U;
    unsigned int     timeoutCycleCount = IFX_CFG_SSW_CCUCON_LCK_BIT_TIMEOUT_COUNT;
    scuOsccon.U = CLOCK_OSCCON.U;

#if (IFX_CFG_SSW_CLOCK_EXT_CLOCK == 1)
    /* external clock selected */
    scuOsccon.B.MODE = 2U;
#else
    /* oscillator enabled */
    scuOsccon.B.MODE = 0U;
#endif

    while (CLOCK_CCUSTAT.B.LCK != 0U)
    {
        IFX_CFG_SSW_LOOP_TIMEOUT_CHECK(timeoutCycleCount, initError);
    }

    CLOCK_OSCCON.U = scuOsccon.U;

    if (initError)
    {
        Ifx_Ssw_debug();
    }
}

void Ifx_Ssw_PllInit(void)
{
    if (IfxClock_init(&IfxClock_defaultClockConfig) != 0U)
    {
        __debug();
    }
}

#endif /* End of IFX_CFG_SSW_ENABLE_PLL_INIT */

/* Callout hook API macro for XTAL Source Check
 * This need to be configured by application to do XTAL Source checks.
 * This hook is by default defined to empty call by startup implementation.
 */
#if IFX_CFG_SSW_ENABLE_XTALSRC_CHECK == 1U
void Ifx_Ssw_XtalSrc_Check(void)
{
}

#endif /* End of IFX_CFG_SSW_ENABLE_XTALSRC_CHECK */

/* Callout hook API macro to configure PMIC Voltage shift
 * This hook is by default defined to empty call by startup implementation.
 */
#if IFX_CFG_SSW_ENABLE_PMIC_VOLTAGESHIFT == 1U
void Ifx_Ssw_Pmic_VoltageShift(void)
{
}

#endif /* End of IFX_CFG_SSW_ENABLE_PMIC_VOLTAGESHIFT */

/* Callout hook API macro to configure AUTOSAR Services Start
 * This hook is by default defined to empty call by startup implementation.
 */
#if IFX_CFG_SSW_ENABLE_AUTOSAR_SERVICESTART == 1U
void Ifx_Ssw_Autosar_ServicesStart(void)
{
}

#endif /* End of IFX_CFG_SSW_ENABLE_AUTOSAR_SERVICESTART */

/* Callout hook API macro for MBIST check for SSHs, other than DSPR0-5 and DMARAM
 * This callout hook is referenced in Startup sequence. This need to be configured by application to
 * do MBIST checks. This hook is by default defined to empty call by startup implementation.
 */
#if IFX_CFG_SSW_ENABLE_MBIST == 1U
void Ifx_Ssw_Mbist(void)
{
}

#endif /* End of IFX_CFG_SSW_ENABLE_MBIST */

/* Callout hook API macro for SMU alarm handling
 * This need to be configured by application to do SMU alarm handling.
 * This hook is by default defined to empty call by startup implementation.
 */
#if IFX_CFG_SSW_ENABLE_SMU == 1U
void Ifx_Ssw_Smu(void)
{
}

#endif /* End of IFX_CFG_SSW_ENABLE_SMU */

/* Callout hook API macro for STL startup tests
 * This need to be configured by application to do STL startup tests.
 * This hook is by default defined to empty call by startup implementation.
 */
#if IFX_CFG_SSW_ENABLE_SAFETY_LIBRARY_TESTS == 1U
void Ifx_Ssw_SafetyLibraryTests(void)
{
}

#endif /* End of IFX_CFG_SSW_ENABLE_SAFETY_LIBRARY_TESTS */

/* Callout hook API macro for PROT and APU initialization
 * This need to be configured by application to do PROT and APU initialization.
 * This hook is by default defined to empty call by startup implementation.
 */
#if IFX_CFG_SSW_ENABLE_AP_INIT == 1U
#include "IfxCpu_reg.h"
#include "IfxInt_reg.h"
void  Ifx_Ssw_AP_Init(void)
{
    void allowAccess(void);
    allowAccess();
}


#endif /* End of IFX_CFG_SSW_ENABLE_AP_INIT */

/* Hook API macro for MultiCore Sync before Core0 Application Entry
 * This hook is used to run STL tests before Application Entry
 * This hook is by default defined to empty call by startup implementation.
 */
void Ifx_Ssw_MultiCore_Sync_Cpu0(void)
{
}

/* Hook API macro for MultiCore Sync before Core1 Application Entry
 * This hook is used to run STL tests before Application Entry
 * This hook is by default defined to empty call by startup implementation.
 */
void Ifx_Ssw_MultiCore_Sync_Cpu1(void)
{
}

/* Hook API macro for MultiCore Sync before Core2 Application Entry
 * This hook is used to run STL tests before Application Entry
 * This hook is by default defined to empty call by startup implementation.
 */
void Ifx_Ssw_MultiCore_Sync_Cpu2(void)
{
}

/* Hook API macro for MultiCore Sync before Core3 Application Entry
 * This hook is used to run STL tests before Application Entry
 * This hook is by default defined to empty call by startup implementation.
 */
void Ifx_Ssw_MultiCore_Sync_Cpu3(void)
{
}

/* Hook API macro for MultiCore Sync before Core4 Application Entry
 * This hook is used to run STL tests before Application Entry
 * This hook is by default defined to empty call by startup implementation.
 */
void Ifx_Ssw_MultiCore_Sync_Cpu4(void)
{
}

/* Hook API macro for MultiCore Sync before Core5 Application Entry
 * This hook is used to run STL tests before Application Entry
 * This hook is by default defined to empty call by startup implementation.
 */
void Ifx_Ssw_MultiCore_Sync_Cpu5(void)
{
}

/* Hook API macro for CSRM SYNC POINT B
 * This hook is by default defined to empty call by startup implementation.
 */
void Ifx_Ssw_CsrmSync_B(void)
{
}

/* Callout hook API macro for CSRM SYNC POINT C
 * This hook is by default defined to empty call by startup implementation.
 */
void Ifx_Ssw_CsrmSync_C(void)
{
}

/* Callout hook API macro for CSRM SYNC POINT D
 * This hook is by default defined to empty call by startup implementation.
 */
void Ifx_Ssw_CsrmSync_D(void)
{
}

#if defined(__TASKING__)
#pragma endoptimize
#elif defined(__HIGHTEC__) && !defined(__clang__)
#pragma GCC reset_options
#elif defined(__GNUC__) && !defined(__HIGHTEC__)
#pragma GCC reset_options
#endif
